# AI评分功能

## 功能概述

AI评分功能集成了火山引擎的AI模型，为教师提供智能化的作业评分服务。支持单个文件和批量文件的AI评分，能够自动检测已有评分，避免重复评分。

## 核心功能

### 1. 单个文件AI评分
- 支持Word文档(.docx)和文本文件(.txt)
- 自动检测文件是否已有评分
- 提供详细的评分结果和评语
- 支持多种评分格式（字母等级、文字等级）

### 2. 批量AI评分
- 支持目录级别的批量处理
- 智能跳过已有评分的文件
- 提供详细的处理结果统计
- 支持三种评分范围：整个仓库、某个班级、某次作业

### 3. 评分检测机制
- 智能检测Word文档表格中的评分
- 检测段落中的评分信息
- 支持多种评分格式识别
- 防止重复评分

## 使用方法

### 单个文件评分
1. 在文件列表中选择要评分的文件
2. 点击"AI评分"按钮
3. 系统自动检测是否已有评分
4. 如无评分，调用AI进行评分
5. 评分结果自动写入文件

### 批量评分
1. 点击"批量AI评分"按钮
2. 选择评分范围（仓库/班级/作业）
3. 选择目标仓库和班级
4. 确认评分设置
5. 开始批量评分处理

## 技术特点

### API集成
- 使用火山引擎Ark API
- 支持多种AI模型
- 智能错误处理和重试机制
- API调用频率限制

### 文件处理
- 支持Word文档和文本文件
- 智能内容提取
- 安全的文件路径验证
- 自动备份机制

### 评分格式
- **字母等级**: A、B、C、D、E
- **文字等级**: 优秀、良好、中等、及格、不及格
- **数字等级**: 90-100、80-89、70-79、60-69、0-59

## 配置要求

### 环境变量
```bash
# 火山引擎API密钥
ARK_API_KEY=your_api_key_here

# AI模型名称
ARK_MODEL=deepseek-r1-250528
```

### 网络要求
- 需要访问火山引擎API服务
- 建议配置代理（如需要）
- 确保DNS解析正常

## 故障排除

### 常见问题
1. **API密钥错误**: 检查ARK_API_KEY配置
2. **网络连接问题**: 检查网络和代理设置
3. **文件格式不支持**: 确保文件为.docx或.txt格式
4. **权限问题**: 确保有文件读写权限

### 错误处理
- 自动重试机制
- 详细的错误日志
- 用户友好的错误提示
- 优雅的降级处理

## 最佳实践

### 使用建议
1. 批量评分前先备份文件
2. 定期检查API使用量
3. 合理设置评分频率
4. 及时处理评分异常

### 性能优化
1. 使用批量评分提高效率
2. 避免重复评分
3. 合理配置API调用间隔
4. 定期清理日志文件
