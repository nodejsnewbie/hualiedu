# 校历功能使用指南

## 功能概述

校历功能为教师提供了完整的学期管理和课程安排系统，包括：

1. **学期管理** - 设置学期开始和结束日期
2. **课程管理** - 添加和管理课程信息
3. **课程安排** - 设置课程的具体上课时间和地点
4. **课程表展示** - 按周查看课程安排

## 使用步骤

### 1. 设置学期信息

**方法一：通过学期管理页面**
1. 在首页点击"学期管理"（仅管理员可见）
2. 点击"前往管理后台"按钮
3. 添加新学期，设置：
   - 学期名称（如：2024年秋季学期）
   - 学期第一周第一天上课日期
   - 学期结束日期
   - 设置为当前活跃学期

**方法二：直接访问管理后台**
1. 登录管理后台 (`/grading/admin/`)
2. 进入"学期"管理页面
3. 添加新学期，设置：
   - 学期名称（如：2024年秋季学期）
   - 学期第一周第一天上课日期
   - 学期结束日期
   - 设置为当前活跃学期

**注意：** 本系统使用自定义管理后台，URL路径为 `/grading/admin/`，学期管理页面的链接会自动跳转到正确的地址。

### 2. 添加课程

1. 在首页点击"课程管理"
2. 填写课程信息：
   - 课程名称
   - 上课地点
   - 课程描述（可选）
3. 点击"添加课程"

### 3. 设置课程安排

1. 在课程管理页面，找到要安排的课程
2. 点击"添加安排"按钮
3. 设置课程安排：
   - 星期几上课
   - 第几大节上课
   - 开始周次
   - 结束周次
4. 点击"添加安排"

### 4. 查看课程表

1. 在首页点击"校历课程表"
2. 可以查看当前周的课程安排
3. 使用"上一周"/"下一周"按钮浏览不同周次的课程表

## 功能特点

### 学期管理
- 支持多个学期管理
- 自动计算学期总周数
- 确保只有一个活跃学期
- 提供专门的学期管理页面
- 权限控制：只有管理员可以管理学期

### 课程管理
- 教师只能管理自己的课程
- 支持课程描述信息
- 记录上课地点

### 课程安排
- 支持5个时间段（第一大节到第五大节）
- 支持7天课程安排（周一到周日）
- 灵活设置上课周次范围
- 防止同一时间段重复安排

### 课程表展示
- 按周显示课程安排
- 显示课程名称、地点和上课周次
- 支持周次导航
- 显示当前日期对应的周次

## 数据模型

### Semester（学期）
- `name`: 学期名称
- `start_date`: 学期开始日期
- `end_date`: 学期结束日期
- `is_active`: 是否为当前学期

### Course（课程）
- `semester`: 所属学期
- `teacher`: 授课教师
- `name`: 课程名称
- `description`: 课程描述
- `location`: 上课地点

### CourseSchedule（课程安排）
- `course`: 所属课程
- `weekday`: 星期几（1-7）
- `period`: 第几大节（1-5）
- `start_week`: 开始周次
- `end_week`: 结束周次

## 时间段设置

- **第一大节**: 8:00-9:40
- **第二大节**: 10:00-11:40
- **第三大节**: 14:00-15:40
- **第四大节**: 16:00-17:40
- **第五大节**: 19:00-20:40

## 权限控制

- 普通教师只能管理自己的课程
- 超级管理员可以管理所有课程
- 需要登录才能访问校历功能

## 技术实现

- 使用Django ORM进行数据管理
- 支持多租户架构
- 响应式Web界面设计
- AJAX异步数据提交
- 自动计算当前周次

## 注意事项

1. 必须先设置学期信息才能使用课程管理功能
2. 同一时间段不能安排多个课程
3. 课程安排的时间范围不能超过学期总周数
4. 建议在学期开始前完成课程安排设置
